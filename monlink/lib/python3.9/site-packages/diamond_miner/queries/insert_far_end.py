from dataclasses import dataclass

from diamond_miner.defaults import UNIVERSE_SUBSET
from diamond_miner.queries.query import Query, rtt_table, results_table, far_end_table
from diamond_miner.typing import IPNetwork

from dataclasses import field

@dataclass(frozen=True)
class InsertFarEnd(Query):

    def statement(
        self, measurement_id: str, subset: IPNetwork = UNIVERSE_SUBSET
    ) -> str:
        return f"""INSERT INTO {far_end_table(measurement_id)} FORMAT CSV"""
